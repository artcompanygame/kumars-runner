<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Kumarâ€™s Chef Runner â€“ zbieraj dania, unikaj przeszkÃ³d!</title>
  <meta name="description" content="Biegnij kucharzem, zbieraj indyjskie dania, unikaj przeszkÃ³d. 90 sekund zabawy!" />
  <style>
    :root{--bg:#0d0f13;--panel:#141824;--line:#242b3a;--accent:#ff7a18;--accent2:#ffb703;--ink:#f8fafc}
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:radial-gradient(1200px 800px at 50% -20%,#171b27,#0d0f13);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Helvetica Neue,Arial}
    .wrap{max-width:820px;margin:0 auto;padding:16px;display:flex;flex-direction:column;gap:12px}
    header{text-align:center}
    h1{font-size:clamp(22px,4vw,32px);margin:8px 0}
    p{margin:6px 0;opacity:.9}
    .card{background:var(--panel);border:1px solid var(--line);border-radius:16px;padding:12px;box-shadow:0 10px 24px rgba(0,0,0,.25)}
    .hud{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:8px}
    .pill{background:#0e1320;border:1px solid #1b2232;border-radius:999px;padding:8px 12px;text-align:center;font-weight:700}
    canvas{width:100%;height:auto;background:linear-gradient(#1c2333,#0e1420);border:2px solid #2b3350;border-radius:16px;display:block}
    .controls{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-top:10px}
    button{appearance:none;border:0;background:#1a2134;color:#fff;padding:12px 14px;border-radius:12px;font-weight:800;cursor:pointer;border:1px solid #2a3350}
    button:hover{filter:brightness(1.08)}
    .primary{background:linear-gradient(180deg,var(--accent2),var(--accent));color:#2b1400;border-color:#9a5a00}
    .footer{text-align:center;opacity:.7;font-size:12px;margin-top:6px}
    .hidden{display:none!important}
    .touch{display:flex;gap:8px;margin-top:8px}
    .touch>button{flex:1}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div style="font-size:13px;letter-spacing:.12em;text-transform:uppercase;opacity:.8">Kumarâ€™s</div>
      <h1>Chef Runner â€“ zbieraj dania, unikaj przeszkÃ³d!</h1>
      <p>Stery: <strong>â† â†’</strong> lub przesuw palcem. <strong>Skok</strong> (spacja / tap). Masz <strong>90 sekund</strong>.</p>
    </header>

    <div class="card">
      <div class="hud">
        <div class="pill">â±ï¸ Czas: <span id="time">90</span>s</div>
        <div class="pill">â­ Wynik: <span id="score">0</span></div>
        <div class="pill">â¤ï¸ Å»ycia: <span id="lives">3</span></div>
        <div class="pill">ğŸ† Rekord: <span id="best">0</span></div>
      </div>
      <canvas id="game" width="400" height="640" aria-label="Kumar's Chef Runner â€“ gra"></canvas>
      <div class="controls">
        <button id="btnStart" class="primary">â–¶ï¸ Start</button>
        <button id="btnShare">ğŸ“£ UdostÄ™pnij</button>
        <button id="btnMute">ğŸ”Š DÅºwiÄ™k</button>
      </div>
      <div class="touch">
        <button id="btnLeft">â¬…ï¸ Lewo</button>
        <button id="btnJump">â¤´ï¸ Skok</button>
        <button id="btnRight">â¡ï¸ Prawo</button>
      </div>
      <div class="footer">Wersja demo: dziaÅ‚a bez Å¼adnych dodatkowych plikÃ³w. <br>JeÅ›li wgrasz <code>logo.png</code> do tego samego folderu â€“ logo pokaÅ¼e siÄ™ automatycznie.</div>
    </div>
  </div>

<script>
(() => {
  const GAME_TIME = 90_000, GRAVITY = 1500, MOVE_SPEED = 260, JUMP_VY = -520;
  const LANES = 3, LANE_W = 110;
  const DISHES = [
    { name: 'Butter Chicken', points: 5, sprite: 'ğŸ›' },
    { name: 'Samosa', points: 4, sprite: 'ğŸ¥Ÿ' },
    { name: 'Naan', points: 3, sprite: 'ğŸ¥–' },
    { name: 'Mango Lassi', points: 6, sprite: 'ğŸ¥­' },
  ];
  const OBSTACLES = [
    { name: 'Rozlana zupa', damage: 1, sprite: 'ğŸ¥£' },
    { name: 'GorÄ…ca patelnia', damage: 1, sprite: 'ğŸ³' },
    { name: 'Chilli', damage: 1, sprite: 'ğŸŒ¶ï¸' },
  ];

  const canvas = document.getElementById('game'), ctx = canvas.getContext('2d');
  const hudTime = document.getElementById('time'), hudScore = document.getElementById('score');
  const hudLives = document.getElementById('lives'), hudBest = document.getElementById('best');
  const btnStart = document.getElementById('btnStart'), btnShare = document.getElementById('btnShare');
  const btnMute = document.getElementById('btnMute'), bL = document.getElementById('btnLeft');
  const bR = document.getElementById('btnRight'), bJ = document.getElementById('btnJump');

  const W = canvas.width, H = canvas.height;
  const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  let audioEnabled = false;
  function beep(freq = 880, dur = 0.08, vol=0.05){
    if(!audioEnabled) return;
    const o = audioCtx.createOscillator(), g = audioCtx.createGain();
    o.connect(g); g.connect(audioCtx.destination);
    o.type='sine'; o.frequency.value=freq; g.gain.value=vol; o.start();
    setTimeout(()=>o.stop(), dur*1000);
  }

  let state='idle', score=0, best=Number(localStorage.getItem('kcr_best')||0), lives=3, startTs=0;
  hudBest.textContent = best;
  const groundY = H - 80;
  const lanesX = Array.from({length:LANES}, (_,i)=> (W/2 - ((LANES-1)/2)*LANE_W) + i*LANE_W);
  const player = { lane:1, x:lanesX[1], y:groundY, w:56, h:72, vy:0, onGround:true };
  const collectibles=[], obstacles=[]; let spawnTimer=0; let speed=220;

  // Logo â€“ jeÅ›li nie istnieje, po prostu siÄ™ nie wyÅ›wietli (bez bÅ‚Ä™du)
  const logo = new Image(); logo.onload=()=>{}; logo.onerror=()=>{}; logo.src='logo.png';

  function clamp(v,min,max){return Math.max(min,Math.min(max,v));}
  function elapsed(){return Date.now()-startTs;}
  const keys = new Set();
  window.addEventListener('keydown', e=>{
    if(['ArrowLeft','ArrowRight',' '].includes(e.key)) e.preventDefault();
    keys.add(e.key); if(state==='idle' && (e.key===' '||e.key==='ArrowRight')) startGame();
  });
  window.addEventListener('keyup', e=>keys.delete(e.key));
  function moveLane(d){ player.lane = clamp(player.lane+d,0,LANES-1); player.x = lanesX[player.lane]; }
  function jump(){ if(player.onGround){ player.vy=-520; player.onGround=false; beep(1200,0.07);} }

  let touchStartX=0, touchStartY=0;
  canvas.addEventListener('pointerdown', e=>{ touchStartX=e.clientX; touchStartY=e.clientY; });
  canvas.addEventListener('pointerup', e=>{
    const dx=e.clientX-touchStartX, dy=e.clientY-touchStartY;
    if(Math.abs(dx)>Math.abs(dy)){ if(dx>20) moveLane(+1); else if(dx<-20) moveLane(-1); }
    else { jump(); }
  });
  bL.addEventListener('click',()=>moveLane(-1)); bR.addEventListener('click',()=>moveLane(+1)); bJ.addEventListener('click',()=>jump());
  btnMute.addEventListener('click',()=>{ audioEnabled=!audioEnabled; btnMute.textContent=audioEnabled?'ğŸ”ˆ DÅºwiÄ™k ON':'ğŸ”‡ DÅºwiÄ™k OFF'; if(audioEnabled && audioCtx.state==='suspended') audioCtx.resume(); });
  btnStart.addEventListener('click',()=>{ if(state==='idle'||state==='ended') startGame(); else if(state==='running') pauseGame(); else resumeGame(); });
  btnShare.addEventListener('click', async()=>{
    const url = new URL(window.location.href); url.searchParams.set('score', String(score));
    const text = `MÃ³j wynik w Kumarâ€™s Chef Runner: ${score} â­`;
    if(navigator.share){ try{ await navigator.share({title:document.title, text, url:url.toString()}); return;}catch{} }
    const fb = new URL('https://www.facebook.com/sharer/sharer.php'); fb.searchParams.set('u', url.toString()); fb.searchParams.set('quote', text); window.open(fb.toString(),'_blank');
  });

  let last=0; function loop(ts){ if(state!=='running') return; if(!last) last=ts; const dt=Math.min(0.033,(ts-last)/1000); last=ts;
    update(dt); render();
    const remaining=Math.max(0,GAME_TIME-elapsed()); document.getElementById('time').textContent=Math.ceil(remaining/1000);
    if(remaining<=0 || lives<=0){ endGame(); return; } requestAnimationFrame(loop); }

  function startGame(){ score=0; lives=3; document.getElementById('score').textContent=0; document.getElementById('lives').textContent=lives;
    spawnTimer=0; speed=220; player.lane=1; player.x=lanesX[1]; player.y=groundY; player.vy=0; player.onGround=true;
    collectibles.length=0; obstacles.length=0; startTs=Date.now(); state='running'; last=0; requestAnimationFrame(loop); btnStart.textContent='â¸ï¸ Pauza'; }
  function pauseGame(){ state='paused'; btnStart.textContent='â–¶ï¸ WznÃ³w'; }
  function resumeGame(){ state='running'; last=0; requestAnimationFrame(loop); btnStart.textContent='â¸ï¸ Pauza'; }
  function endGame(){ state='ended'; if(score>best){best=score; localStorage.setItem('kcr_best',String(best));} hudBest.textContent=best; btnStart.textContent='ğŸ” Jeszcze raz';
    render(); ctx.fillStyle='rgba(0,0,0,.55)'; ctx.fillRect(0,0,W,H); ctx.fillStyle='#fff'; ctx.textAlign='center';
    ctx.font='bold 28px system-ui, sans-serif'; ctx.fillText('Koniec!', W/2, H/2 - 18); ctx.font='20px system-ui, sans-serif'; ctx.fillText(`Wynik: ${score}  â€¢  Rekord: ${best}`, W/2, H/2 + 12); }

  function update(dt){
    if(keys.has('ArrowLeft')) moveLane(-1); if(keys.has('ArrowRight')) moveLane(+1); if(keys.has(' ')){ jump(); keys.delete(' '); }
    player.vy += GRAVITY*dt; player.y += player.vy*dt; if(player.y>=groundY){ player.y=groundY; player.vy=0; player.onGround=true; }
    spawnTimer -= dt; if(spawnTimer<=0){ const isObstacle=Math.random()<0.55; const lane=(Math.random()*LANES)|0; const x=lanesX[lane];
      if(isObstacle){ const t=OBSTACLES[(Math.random()*OBSTACLES.length)|0]; obstacles.push({x,y:-40,type:t}); }
      else { const d=DISHES[(Math.random()*DISHES.length)|0]; collectibles.push({x,y:-40,type:d}); }
      const hard=1+elapsed()/40000; spawnTimer=0.6/hard; speed=220+(elapsed()/1000)*6; }
    for(let i=collectibles.length-1;i>=0;i--){ const c=collectibles[i]; c.y += speed*dt;
      if(collides(c.x-18,c.y-18,36,36, player.x-28, player.y-36, 56,64)){ score += c.type.points; document.getElementById('score').textContent=score; collectibles.splice(i,1); beep(1100,0.06,0.06); }
      else if(c.y>H+40) collectibles.splice(i,1); }
    for(let i=obstacles.length-1;i>=0;i--){ const o=obstacles[i]; o.y += speed*dt;
      if(collides(o.x-20,o.y-16,40,32, player.x-28, player.y-36, 56,64)){ lives -= o.type.damage; document.getElementById('lives').textContent=lives; obstacles.splice(i,1); beep(220,0.08,0.07); }
      else if(o.y>H+40) obstacles.splice(i,1); }
  }
  function collides(ax,ay,aw,ah,bx,by,bw,bh){ return !(ax+aw<bx||ax>bx+bw||ay+ah<by||ay>by+bh); }

  function render(){
    ctx.clearRect(0,0,W,H); drawBackground();
    if(logo.complete && logo.naturalWidth>0){ const lw=110, lh=110; ctx.save(); ctx.globalAlpha=0.85; ctx.drawImage(logo,10,10,lw,lh); ctx.restore(); }
    ctx.strokeStyle='rgba(255,255,255,.08)'; ctx.lineWidth=2; ctx.setLineDash([6,10]);
    const lanesXLocal = Array.from({length:LANES}, (_,i)=> (W/2 - ((LANES-1)/2)*LANE_W) + i*LANE_W);
    for(let i=0;i<LANES;i++){ ctx.beginPath(); ctx.moveTo(lanesXLocal[i],0); ctx.lineTo(lanesXLocal[i],H); ctx.stroke(); } ctx.setLineDash([]);
    for(const c of collectibles) drawSprite(c.x, c.y, c.type.sprite, 34);
    for(const o of obstacles) drawSprite(o.x, o.y, o.type.sprite, 34);
    drawSprite(player.x, player.y-12, 'ğŸ‘¨â€ğŸ³', 44);
    ctx.fillStyle='#0b1220'; ctx.fillRect(0, H - 80 + 28, W, 80 - 28);
  }
  function drawBackground(){ const bandH=80, t=(Date.now()/1000);
    for(let i=0;i<6;i++){ const y=i*bandH; ctx.fillStyle=i%2?'#131a2a':'#111728'; ctx.fillRect(0,y,W,bandH);
      ctx.fillStyle='rgba(255,255,255,.04)'; for(let k=0;k<4;k++){ const x=(k*120 + (t*40*(i+1))%120) - 60; ctx.fillRect(x,y+bandH-6,80,3);} } }
  function drawSprite(x,y,txt,size){ ctx.save(); ctx.textAlign='center'; ctx.textBaseline='middle'; ctx.font=`bold ${size}px Apple Color Emoji, Segoe UI Emoji, Noto Color Emoji, system-ui, sans-serif`; ctx.fillText(txt,x,y); ctx.restore(); }

  if(new URLSearchParams(location.search).get('autoplay')==='1') startGame();
})();
</script>
</body>
</html>
